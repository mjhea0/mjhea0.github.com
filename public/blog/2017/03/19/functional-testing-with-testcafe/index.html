
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>
    
      Functional Testing with TestCafe
     
   </title>
  <meta name="author" content="Michael Herman">

  
  <meta name="description" content="Let's look at how to write end-to-end tests with TestCafe.">
  <meta name="keywords" content="node, node.js, testing, TestCafe, javascript, automated tests, functional testing, end-to-end testing, e2e, e2e tests">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mherman.org/blog/2017/03/19/functional-testing-with-testcafe">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Michael Herman" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>


  <!-- hello bar -->
  <link rel="stylesheet" href="/stylesheets/hellobar.css">
  <!-- hello bar -->
  <script type="text/javascript" src="/javascripts/hellobar.js"></script>

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-37074204-1', 'auto');
    ga('send', 'pageview');

  </script>



</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Michael Herman</a></h1>
  
    <h2>Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
  
  
  
  
  
    
      <form action="http://google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="mherman.org" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/talks">Talks</a></li>
</ul>

</nav>
      <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=mhermanorg" id="_carbonads_js" media="(min-width: 768px)"></script>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Functional Testing With TestCafe</h1>
      
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-03-19T16:37:53-06:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>4:37 pm</span></time>
        
        
      </p>
    
  </header>


<div class="entry-content"><p>Today we are going to dive into the world of functional web testing with <a href="https://devexpress.github.io/testcafe/">TestCafe</a>.</p>

<p>Unlike the majority of other end-to-end (e2e) testing tools, TestCafe is not dependent on Selenium or WebDriver. Instead, it injects scripts into the browser to communicate directly with the DOM and handle events. It works on any modern browser that supports HTML5 without any plugins. Further, it supports all major operating systems and can run simultaneously on multiple browsers and machines.</p>

<p>We will be using:</p>

<ul>
<li>TestCafe v<a href="https://github.com/DevExpress/testcafe/releases/tag/v0.13.0">0.13.0</a></li>
<li>Chrome v<a href="https://chromereleases.googleblog.com/2017/03/stable-channel-update-for-desktop.html">57</a></li>
<li>NodeJS v<a href="https://nodejs.org/docs/v7.6.0/api/all.html">7.6.0</a></li>
</ul>


<p>Please review the <a href="http://devexpress.github.io/testcafe/documentation/getting-started/">Getting Started</a> guide before beginning.</p>

<h2>Contents</h2>

<ol>
<li>Objectives</li>
<li>Project Setup</li>
<li>Writing Tests</li>
<li>Browser Support</li>
<li>Continuous Integration</li>
<li>Next Steps</li>
</ol>


<h2>Objectives</h2>

<p>By the end of this tutorial, you should be able to&hellip;</p>

<ol>
<li>Set up TestCafe with an existing Node app</li>
<li>Write TestCafe tests using the <a href="https://martinfowler.com/bliki/PageObject.html">PageObject</a> pattern</li>
<li>Test a Node application with functional tests</li>
<li>Integrate TestCafe into a continuous integration process</li>
<li>Configure TestCafe to work with a headless browser</li>
</ol>


<h2>Project Setup</h2>

<p>Start by cloning the base project structure:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>git clone https://github.com/mjhea0/testcafe-example --branch v1 --single-branch -b master
</span></code></pre></td></tr></table></div></figure>


<p>Install the dependencies, and then fire up the app by running <code>npm start</code> to make sure all is well. Navigate to <a href="http://localhost:3000/">http://localhost:3000/</a> in your browser and you should see a list of jobs in HTML. Experiment with the app. Add a job. Update a job. Delete a job. This is what we will be testing. Kill the server when done.</p>

<div style="text-align:center;">
  <img src="/images/blog/node-jobs.png" style="max-width: 100%; border:0; box-shadow: none;" alt="node jobs">
</div>


<p>Install TestCafe:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>npm install testcafe@0.13.0 --save-dev
</span></code></pre></td></tr></table></div></figure>


<p>With that, you can start running tests.</p>

<blockquote><p><strong>NOTE:</strong> If you were using a Selenium-based testing tool you would need to install both Selenium and Web Driver, which can be difficult depending on your system setup.</p></blockquote>

<p>Add a <code>test</code> command to the <code>scripts</code> in <em>package.json</em>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="s2">&quot;scripts&quot;</span><span class="err">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;node ./bin/www&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;node_modules/testcafe/bin/testcafe.js chrome tests/&quot;</span>
</span><span class='line'><span class="p">}</span><span class="err">,</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here, we specified the path to TestCafe in our &ldquo;node_modules&rdquo; folder along with a <a href="http://devexpress.github.io/testcafe/documentation/using-testcafe/command-line-interface.html#browser-list">target browser</a>, <code>chrome</code>, and a  <a href="http://devexpress.github.io/testcafe/documentation/using-testcafe/command-line-interface.html#file-pathglob-pattern">path</a> to where all tests will be located, <code>tests/</code>.</p>

<p>Now, you can use <code>npm test</code> to run TestCafe.</p>

<p>Let&rsquo;s get a test set up. Add a &ldquo;tests&rdquo; folder to the project root, and add an <em>index.js</em> file to it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">Selector</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;testcafe&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">fixture</span><span class="p">(</span><span class="s1">&#39;Getting Started&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">page</span><span class="p">(</span><span class="s1">&#39;https://github.com&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;Find &quot;testcafe-example&quot; repo on GitHub&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">repo</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;.repo-list &gt; li &gt; div&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// search github</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;form[action=&quot;/search&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;testcafe-example user:mjhea0&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pressKey</span><span class="p">(</span><span class="s1">&#39;enter&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// check li for results</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">repo</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">contains</span><span class="p">(</span><span class="s1">&#39;mjhea0/testcafe-example&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>What&rsquo;s happening?</p>

<ol>
<li>Since <em>all</em> tests are organized into <a href="http://devexpress.github.io/testcafe/documentation/test-api/test-code-structure.html#fixtures">fixtures</a>, we started with a <code>fixture()</code> function.</li>
<li>Next, we specified a start URL - <code>http://devexpress.github.io/testcafe/example</code> - via the <code>page()</code> <a href="http://devexpress.github.io/testcafe/documentation/test-api/test-code-structure.html#specifying-the-start-webpage">method</a>.</li>
<li>From there, we added the test code into a <code>test()</code> <a href="http://devexpress.github.io/testcafe/documentation/test-api/test-code-structure.html#tests">function</a>, which takes an async function along with the <a href="http://devexpress.github.io/testcafe/documentation/test-api/test-code-structure.html#test-controller">test controller</a> object.</li>
<li><code>await</code> is then used to wait for certain <a href="http://devexpress.github.io/testcafe/documentation/test-api/actions/">actions</a> to complete. In this case, we used <code>typeText()</code> and <code>pressKey()</code> to search GitHub.</li>
<li>On the GitHub search results page, we used a <code>Selector()</code> <a href="http://devexpress.github.io/testcafe/documentation/test-api/selecting-page-elements/selectors.html">function</a> to parse the DOM.</li>
<li>Finally, we asserted that the actual results contain the expected results.</li>
</ol>


<blockquote><p><strong>NOTE:</strong> If you&rsquo;re new to <a href="https://github.com/tc39/ecmascript-asyncawait">async/await</a>, check out <a href="https://ponyfoo.com/articles/understanding-javascript-async-await">Understanding JavaScript’s async await</a>.</p></blockquote>

<p>Try this out! Run <code>npm test</code>. If all goes well Chrome should fire up and execute the test. Once done, you should see something like this in your terminal:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>Running tests in:
</span><span class='line'>- Chrome 57.0.2987 / Mac OS X 10.11.6
</span><span class='line'>
</span><span class='line'>Getting Started
</span><span class='line'>✓ Find <span class="s2">&quot;testcafe-example&quot;</span> repo on GitHub
</span></code></pre></td></tr></table></div></figure>


<p>Make sense? No? Continue to run the test and review the above steps until it does. Make sure you understand what&rsquo;s happening before moving on.</p>

<h2>Writing Tests</h2>

<p>Add a new file called <em>jobs.js</em> to the &ldquo;tests&rdquo; folder:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">Selector</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;testcafe&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">fixture</span><span class="p">(</span><span class="s1">&#39;Node Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">page</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then update the <code>test</code> command in <em>package.json</em>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="s2">&quot;test&quot;</span><span class="err">:</span> <span class="s2">&quot;node_modules/testcafe/bin/testcafe.js chrome tests/jobs.js --app &#39;npm start&#39;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>tests/jobs.js</code> ignores the example GitHub test found in <em>index.js</em> so that we can focus just on the tests added to <em>jobs.js</em>. The <code>--app</code> <a href="https://devexpress.github.io/testcafe/documentation/using-testcafe/command-line-interface.html#-a-command---app-command">option</a> is used to launch the Node app so that TestCafe can interact with it.</p>

<p>Try it. You should see the page load in Chrome. With that, let&rsquo;s test each of our app&rsquo;s CRUD functions.</p>

<h3>GET ALL Jobs</h3>

<p>Update <em>jobs.js</em>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">Selector</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;testcafe&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">fixture</span><span class="p">(</span><span class="s1">&#39;Node Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">page</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">tableRows</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;tbody &gt; tr&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">addJobButton</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;a.btn.btn-primary&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">firstJob</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;tbody &gt; tr&#39;</span><span class="p">).</span><span class="nx">withText</span><span class="p">(</span><span class="s1">&#39;Horse Whisperer&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// check title, add job button, table rows, and job exists</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">addJobButton</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;Add New Job&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">firstJob</span><span class="p">.</span><span class="nx">exists</span><span class="p">).</span><span class="nx">ok</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>What&rsquo;s happening? Review the code above, line by line. It should be fairly straightforward.  Turn to the <a href="https://devexpress.github.io/testcafe/documentation/test-api/selecting-page-elements/">docs</a> for help, adding comments as necessary.</p>

<p>Run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>Node Jobs
</span><span class='line'>✓ All Jobs
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="m">1</span> passed <span class="o">(</span>0s<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Before moving on, refactor out the selectors so that they can be re-used by other test cases:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">Selector</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;testcafe&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// selectors</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">tableRows</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;tbody &gt; tr&#39;</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">addJobButton</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;a.btn.btn-primary&#39;</span><span class="p">);</span>
</span><span class='line'><span class="kr">const</span> <span class="nx">firstJob</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;tbody &gt; tr&#39;</span><span class="p">).</span><span class="nx">withText</span><span class="p">(</span><span class="s1">&#39;Horse Whisperer&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">fixture</span><span class="p">(</span><span class="s1">&#39;Node Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">page</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// check title, add job button, table rows, and job exists</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">addJobButton</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;Add New Job&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">firstJob</span><span class="p">.</span><span class="nx">exists</span><span class="p">).</span><span class="nx">ok</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Add Job</h3>

<p>Start by adding a new <code>test()</code> function to <em>jobs.js</em>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">test</span><span class="p">.</span><span class="nx">only</span><span class="p">(</span><span class="s1">&#39;New Job&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p><strong>NOTE:</strong> Can you guess what <code>only()</code> does? Try running the tests to see. Please review the <a href="https://devexpress.github.io/testcafe/documentation/test-api/test-code-structure.html#skipping-tests">docs</a> for more info.</p></blockquote>

<p>Think about the steps an end user has to go through to add a job:</p>

<ol>
<li>Click the add job button</li>
<li>Fill out the form</li>
<li>Submit the form</li>
</ol>


<p>Now, try this on your own, step by step, before looking at the solution&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">test</span><span class="p">.</span><span class="nx">only</span><span class="p">(</span><span class="s1">&#39;New Job&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// click add job button</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">addJobButton</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;Add Job&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// fill out form</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;title&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;Python Developer&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;textarea[name=&quot;description&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;Write some Python&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;company&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;Real Python&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;email&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;michael@realpython.com&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">submitButton</span><span class="p">)</span>
</span><span class='line'>  <span class="c1">// check title, table rows, and new job exists</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;tbody &gt; tr&#39;</span><span class="p">).</span><span class="nx">withText</span><span class="p">(</span><span class="s1">&#39;Python Developer&#39;</span><span class="p">).</span><span class="nx">exists</span><span class="p">).</span><span class="nx">ok</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Make sure to add the selector to the top:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">const</span> <span class="nx">submitButton</span> <span class="o">=</span> <span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;button[type=&quot;submit&quot;]&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Test it out. Then remove the <code>only()</code> and test again:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>Node Jobs
</span><span class='line'>✓ All Jobs
</span><span class='line'>✓ New Job
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="m">2</span> passed <span class="o">(</span>4s<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>What are we missing in this test?</p>

<ol>
<li>What happens if the cancel button is pressed?</li>
<li>What if the end user does not enter data for all the fields?</li>
<li>What if text is entered in the email field but it is not a valid email?</li>
</ol>


<p>Try testing for these on your own.</p>

<h3>Update Job</h3>

<p>Again, start by adding the boilerplate:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;Update Job&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then write out the steps the end user has to take before writing any code:</p>

<ol>
<li>Click the update button</li>
<li>Fill out the form</li>
<li>Submit the form</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;Update Job&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// click update button</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">firstJob</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;a.btn.btn-warning&#39;</span><span class="p">))</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;Update Job&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// fill out form</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;title&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;testing an update&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">replace</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;textarea[name=&quot;description&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">replace</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;company&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">replace</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">typeText</span><span class="p">(</span><span class="s1">&#39;input[name=&quot;email&quot;]&#39;</span><span class="p">,</span> <span class="s1">&#39;t@t.com&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">replace</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">submitButton</span><span class="p">)</span>
</span><span class='line'>  <span class="c1">// check title, table rows, and updated job exists</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1">// why 4?</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">firstJob</span><span class="p">.</span><span class="nx">exists</span><span class="p">).</span><span class="nx">notOk</span><span class="p">()</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">Selector</span><span class="p">(</span><span class="s1">&#39;tbody &gt; tr&#39;</span><span class="p">).</span><span class="nx">withText</span><span class="p">(</span><span class="s1">&#39;testing an update&#39;</span><span class="p">).</span><span class="nx">exists</span><span class="p">).</span><span class="nx">ok</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Test:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>Node Jobs
</span><span class='line'>✓ All Jobs
</span><span class='line'>✓ New Job
</span><span class='line'>✓ Update Job
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="m">3</span> passed <span class="o">(</span>8s<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>What else should you test for? Write the test cases on your own.</p>

<p>Also, did you notice the code smell? There&rsquo;s a lot of code duplication happening between those last two test cases. How could this be better handled?</p>

<p>Finally, did you notice that there are still four jobs in the table? Why? Could there be issues with testing the previous two tests together rather than in isolation? Probably not in this case, but if there are, you could always wrap the update in a new <code>fixture()</code>, since this restores the page to its initial state.</p>

<h3>Delete Job</h3>

<p>Run the app again with <code>npm start</code> to review, from the end user&rsquo;s perspective, what happens when you try to delete a job.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;Delete Job&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// click delete button</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">setNativeDialogHandler</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">clayDryerJob</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;a.btn.btn-danger&#39;</span><span class="p">))</span>
</span><span class='line'>  <span class="c1">// check title, table rows, and updated job exists</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">// why 3?</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">clayDryerJob</span><span class="p">.</span><span class="nx">exists</span><span class="p">).</span><span class="nx">notOk</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Did you notice the <code>setNativeDialogHandler()</code> function? <a href="https://devexpress.github.io/testcafe/documentation/test-api/handling-native-dialogs.html#dialog-handler">This</a> tells TestCafe how to handle the alert.</p>

<p>What if we click &ldquo;cancel&rdquo; instead of &ldquo;ok&rdquo;?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;Delete Job&#39;</span><span class="p">,</span> <span class="nx">async</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// click delete button</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">setNativeDialogHandler</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">)</span> <span class="c1">// =&gt; press ok</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">clayDryerJob</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;a.btn.btn-danger&#39;</span><span class="p">))</span>
</span><span class='line'>  <span class="c1">// check title, table rows, and updated job exists</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">// why 3?</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">clayDryerJob</span><span class="p">.</span><span class="nx">exists</span><span class="p">).</span><span class="nx">notOk</span><span class="p">();</span>
</span><span class='line'>    <span class="c1">// click delete button</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">setNativeDialogHandler</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">)</span> <span class="c1">// =&gt; press cancel</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;a.btn.btn-danger&#39;</span><span class="p">))</span>
</span><span class='line'>  <span class="c1">// check title, table rows, and updated job exists</span>
</span><span class='line'>  <span class="nx">await</span> <span class="nx">t</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">innerText</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="s1">&#39;All Jobs&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="nx">tableRows</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">eql</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">// why 3?</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the tests:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>Node Jobs
</span><span class='line'>✓ All Jobs
</span><span class='line'>✓ New Job
</span><span class='line'>✓ Update Job
</span><span class='line'>✓ Delete Job
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="m">4</span> passed <span class="o">(</span>9s<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, handle any edge cases on you own and clean up the code smell.</p>

<h2>Browser Support</h2>

<p>Aside for Chrome, TestCafe <a href="https://devexpress.github.io/testcafe/documentation/using-testcafe/common-concepts/browser-support.html#officially-supported-browsers">supports</a> a number of browsers out-of-the-box. Further, if you don&rsquo;t need to test browser-dependent functionality, then you can use a headless browser.</p>

<p>Start by installing the <a href="https://github.com/ryx/testcafe-browser-provider-nightmare">plugin</a>, which is powered by <a href="https://github.com/segmentio/nightmare">Nightmare</a>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>npm install testcafe-browser-provider-nightmare@0.0.4 --save-dev
</span></code></pre></td></tr></table></div></figure>


<p>Update the <code>test</code> command in <em>package.json</em>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="s2">&quot;test&quot;</span><span class="err">:</span> <span class="s2">&quot;node_modules/testcafe/bin/testcafe.js nightmare tests/jobs.js --app &#39;npm start&#39;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the tests, and you should see:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>Running tests in:
</span><span class='line'>- Electron 1.6.2 / Mac OS X 10.11.6
</span><span class='line'>
</span><span class='line'>Node Jobs
</span><span class='line'>✓ All Jobs
</span><span class='line'>✓ New Job
</span><span class='line'>✓ Update Job
</span><span class='line'>✓ Delete Job
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="m">4</span> passed <span class="o">(</span>9s<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>There&rsquo;s also a <a href="https://github.com/DevExpress/testcafe-browser-provider-saucelabs">plugin</a> for cross browser support powered by <a href="https://saucelabs.com/">SauceLabs</a>.</p>

<h2>Continuous Integration</h2>

<p>Finally, let&rsquo;s incorporate TestCafe into our Continuous Integration (CI) process with <a href="https://travis-ci.org/">Travis CI</a>.</p>

<blockquote><p><strong>NOTE:</strong> New to Travis? Review the <a href="https://docs.travis-ci.com/user/for-beginners">Travis CI for Complete Beginners</a> guide along with <a href="http://devexpress.github.io/testcafe/documentation/recipes/running-tests-in-firefox-and-chrome-using-travis-ci.html">Running Tests in Firefox and Chrome Using Travis CI</a>.</p></blockquote>

<p>After you enable Travis CI for the repository you are working with, add a <em>.travis.yml</em> file to the project root:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>language: node_js
</span><span class='line'>node_js: <span class="s2">&quot;7&quot;</span>
</span><span class='line'>
</span><span class='line'>dist: trusty
</span><span class='line'>sudo: required
</span><span class='line'>
</span><span class='line'>addons:
</span><span class='line'>  apt:
</span><span class='line'>    sources:
</span><span class='line'>     - google-chrome
</span><span class='line'>    packages:
</span><span class='line'>     - google-chrome-stable
</span><span class='line'>
</span><span class='line'>before_script:
</span><span class='line'>  - <span class="s2">&quot;export DISPLAY=:99.0&quot;</span>
</span><span class='line'>  - <span class="s2">&quot;sh -e /etc/init.d/xvfb start&quot;</span>
</span><span class='line'>  - sleep 3
</span></code></pre></td></tr></table></div></figure>


<p>Here, we added the Node version along with some basic Chrome settings. Also, we have to use <a href="https://docs.travis-ci.com/user/gui-and-headless-browsers/#Using-xvfb-to-Run-Tests-That-Require-a-GUI">xvfb</a> to fake a GUI so that Chrome thinks it&rsquo;s running in a graphical environment.</p>

<hr><br>


<p>That&rsquo;s it. Grab the final code from the <a href="https://github.com/mjhea0/testcafe-example">testcafe-example</a> repo. Comment below if you have questions.</p>
</div>


  <footer>
    <p class="meta">
      
  



  <span class="byline author vcard">Authored by <span class="fn">
  
    Michael Herman
  
  </span></span>


      




<time class='entry-date' datetime='2017-03-19T16:37:53-06:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>4:37 pm</span></time>
      
      

<span class="categories">
  
    <a class='category' href='/blog/categories/node/'>node</a>
  
</span>


    </p>
    
      <div class="sharing">
<!--   
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mherman.org/blog/2017/03/19/functional-testing-with-testcafe/" data-via="" data-counturl="http://mherman.org/blog/2017/03/19/functional-testing-with-testcafe/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
   -->
  <br>
  <!-- AddThis Button BEGIN -->
  <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
  <a class="addthis_button_preferred_1"></a>
  <a class="addthis_button_preferred_2"></a>
  <a class="addthis_button_preferred_3"></a>
  <a class="addthis_button_preferred_4"></a>
  <a class="addthis_button_compact"></a>
  <a class="addthis_counter addthis_bubble_style"></a>
  </div>
  <script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50e5f1cc35ad077d"></script>
  <!-- AddThis Button END -->
  <br>
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2017/01/05/token-based-authentication-with-angular/" title="Previous Post: Token-Based Authentication with Angular">&laquo; Token-Based Authentication with Angular</a>
      
      
        <a class="basic-alignment right" href="/blog/2017/04/18/developing-and-testing-microservices-with-docker/" title="Next Post: Developing and Testing Microservices with Docker">Developing and Testing Microservices with Docker &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


</div>

    </div>
  </div>
  <footer role="contentinfo"><div>
  <span>Copyright &copy; 2017 - Michael Herman</span><br>
  <a href="https://github.com/mjhea0"><i class="fa fa-github-square" style="font-size:2em" aria-hidden="true"></i></a>
  <a href="https://twitter.com/mikeherman"><i class="fa fa-twitter-square" style="font-size:2em" aria-hidden="true"></i></a>
  <a href="http://www.linkedin.com/pub/michael-herman/3b/a94/4"><i class="fa fa-linkedin-square" style="font-size:2em" aria-hidden="true"></i></a>
  <a href="http://www.youtube.com/hermanmu"><i class="fa fa-youtube-square" style="font-size:2em" aria-hidden="true"></i></a>
</div>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'michaelherman';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mherman.org/blog/2017/03/19/functional-testing-with-testcafe/';
        var disqus_url = 'http://mherman.org/blog/2017/03/19/functional-testing-with-testcafe/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
