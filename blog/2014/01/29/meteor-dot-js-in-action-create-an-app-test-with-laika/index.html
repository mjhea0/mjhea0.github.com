
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Meteor.js in Action: Create an App, Test With Laika - Michael Herman</title>
  <meta name="author" content="Michael Herman">

  
  <meta name="description" content="Meteor is a next generation framework used for rapidly developing web apps, which seamlessly combines popular packages like MongoDB, Node.js, and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mherman.org/blog/2014/01/29/meteor-dot-js-in-action-create-an-app-test-with-laika">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Michael Herman" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-37074204-1', 'auto');
    ga('send', 'pageview');

  </script>



</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Michael Herman</a></h1>
  
    <h2>Software Developer</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
  
  
  
  
  
    
      <form action="http://google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="mherman.org" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Meteor.js in Action: Create an App, Test With Laika</h1>
      
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-29T10:51:00-07:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:51 am</span></time>
        
        
      </p>
    
  </header>


<div class="entry-content"><p><img class="center" src="https://raw.github.com/mjhea0/meteor-in-action/master/images/meteor.jpeg"></p>

<p>Meteor is a next generation framework used for rapidly developing web apps, which seamlessly combines popular packages like MongoDB, Node.js, and jQuery, to name a few.</p>

<p>Check out the excellent Meteor <a href="http://docs.meteor.com/">documentation</a> for more information. Grab the code from the repo <a href="https://github.com/mjhea0/meteor-in-action">here</a>.</p>

<p><strong>Please note: Before you can follow this tutorial, please install <a href="http://nodejs.org/download/">Node and npm</a>.</strong></p>

<p>With that, let&rsquo;s start building …</p>

<blockquote><p>This tutorial uses Meteor version <code>0.7.0.1</code> - which, as of writing, is the latest version</p></blockquote>

<h2>TOC</h2>

<ol>
<li><a href="#setup">Setup a Project</a></li>
<li><a href="#create">Create a Basic App</a></li>
<li><a href="#restructure">Restructure</a></li>
<li><a href="#test">Testing Framework</a></li>
<li><a href="#submit">Users can submit answers</a></li>
<li><a href="#submitted">Users can see all submitted answers</a></li>
<li><a href="#vote">Users can up or down vote answers</a></li>
<li><a href="#twitter">Users can login via Twitter</a></li>
<li><a href="#loggedin">Users can only answer or vote if they are logged in</a></li>
<li><a href="#insecure">Remove insecure packages</a></li>
<li><a href="#deployment">Deployment</a></li>
<li><a href="#next">What&rsquo;s next?</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>


<p><a id="setup"></a></p>

<h2>Setup a Project</h2>

<h4>1. Install Meteor and the Meteor Package Manager, <a href="https://github.com/oortcloud/meteorite">Meteorite</a>:</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>curl https://install.meteor.com/ <span class="p">|</span> sh
</span><span class='line'><span class="nv">$ </span>meteor update
</span><span class='line'><span class="nv">$ </span>npm install -g meteorite
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>Alternatively, you can install meteor with npm, <code>npm install -g meteor</code>), however the npm package is not uploaded or maintained by Meteor Development Group</p></blockquote>

<h4>2. Create a Meteor project:</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>meteor create mymeteor
</span></code></pre></td></tr></table></div></figure>


<p>Look! It tells you exactly what to do:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>To run your new app:
</span><span class='line'>   <span class="nb">cd </span>mymeteor
</span><span class='line'>   meteor
</span></code></pre></td></tr></table></div></figure>


<p>Go ahead and run it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span><span class="nb">cd </span>mymeteor
</span><span class='line'><span class="nv">$ </span>meteor
</span><span class='line'><span class="o">[[[[[</span> ~/Desktop/mymeteor <span class="o">]]]]]</span>
</span><span class='line'>
</span><span class='line'><span class="o">=</span>&gt; Meteor server running on: http://localhost:3000/
</span></code></pre></td></tr></table></div></figure>


<p>We just initialized the Meteor server. Navigate to [<a href="http://localhost:3000/">http://localhost:3000/</a>]
(<a href="http://localhost:3000/">http://localhost:3000/</a>), and you should see:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/helloworld.png" alt="helloworld" /></p>

<p>If port 3000 is unavailable, you can use <code>–port</code> as an option:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>meteor --port 1337
</span></code></pre></td></tr></table></div></figure>


<p>Leave the app running. The browser will automatically update as you save changes to your code.</p>

<h5>What&rsquo;s going on here?</h5>

<p>Look at your basic project structure:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>.
</span><span class='line'>├── mymeteor.css
</span><span class='line'>├── mymeteor.html
</span><span class='line'>└── mymeteor.js
</span></code></pre></td></tr></table></div></figure>


<p>Your JS file contains both client and server code:
  ``` javascript
  // client!
  if (Meteor.isClient) {
    Template.hello.greeting = function () {
      return &ldquo;Welcome to mymeteor.&rdquo;;
    };</p>

<pre><code>Template.hello.events({
  'click input' : function () {
    // template data, if any, is available in 'this'
    if (typeof console !== 'undefined')
      console.log("You pressed the button");
  }
});
</code></pre>

<p>  }</p>

<p>  // server!
  if (Meteor.isServer) {
    Meteor.startup(function () {
      // code to run on server at startup
    });
  }
  ```</p>

<p>The behavior of <code>{{greeting}}</code> in the HTML file is controlled by <code>Template</code> within the client-side code in the JS file, as well as the handling of events.</p>

<p><a id="create"></a></p>

<h2>Create a Basic App</h2>

<p>In this example, we&rsquo;ll be creating an app, which displays a question with a list of answers. Users can -</p>

<ol>
<li>Submit answers</li>
<li>See all submitted answers</li>
<li>Up or down vote answers</li>
<li>Login via Twitter</li>
<li>Only answer or vote if they are logged in</li>
<li>View question but not submitted answers without logging in</li>
</ol>


<p>Before we start adding this functionality, let&rsquo;s first restructure the project.</p>

<p><a id="restructure"></a></p>

<h2>Restructure</h2>

<h4>1. Add Packages (err Smart Packages!)</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>mrt add accounts-ui
</span><span class='line'>accounts-ui: Simple templates to add login widgets to an app
</span><span class='line'><span class="nv">$ </span>mrt add accounts-twitter
</span><span class='line'>accounts-twitter: Login service <span class="k">for</span> Twitter accounts
</span><span class='line'><span class="nv">$ </span>mrt add bootstrap-3
</span><span class='line'>bootstrap-3: Provides bootstrap 3.
</span></code></pre></td></tr></table></div></figure>


<p>Watch your browser as you add these. You should see the styles update almost immediately.</p>

<p>You can read more about these packages <a href="http://docs.meteor.com/#accountsui">here</a>, <a href="http://docs.meteor.com/#accounts_api">here</a>, <a href="https://github.com/mangasocial/meteor-bootstrap-3">here</a>. It&rsquo;s pretty awesome that you can add these web components in just a matter of minutes! Awesome for prototyping!</p>

<blockquote><p>You can view the available packages from the terminal by running the command - <code>meteor list</code></p></blockquote>

<h4>2. Add client and server folders</h4>

<p>Add two new folders - &ldquo;client&rdquo; and &ldquo;server&rdquo;. Essentially, if Meteor detects a client folder, all the JavaScript within the folder will be run on the client-side, while JavaScript code found within the server folder will run only on the server-side.</p>

<p>Within the client folder, create a file called &ldquo;mainClient.js&rdquo; and add the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">isClient</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">greeting</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;Welcome to mymeteor.&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Template</span><span class="p">.</span><span class="nx">hello</span><span class="p">.</span><span class="nx">events</span><span class="p">({</span>
</span><span class='line'>    <span class="s1">&#39;click input&#39;</span> <span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// template data, if any, is available in &#39;this&#39;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">console</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;You pressed the button&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then within the server folder, and a file called &ldquo;mainServer.js&rdquo; and add the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">isServer</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Meteor</span><span class="p">.</span><span class="nx">startup</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// code to run on server at startup</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Delete the &ldquo;mymeteor.js&rdquo; file. If you look at your browser, everything should look the same. Add one more folder called &ldquo;tests&rdquo;, which as you probably guessed will include our unit tests along with a file called &ldquo;index.js&rdquo;.</p>

<p>Your project structure should now look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>.
</span><span class='line'>├── client
</span><span class='line'>│   └── mainClient.js
</span><span class='line'>├── mymeteor.css
</span><span class='line'>├── mymeteor.html
</span><span class='line'>├── server
</span><span class='line'>│   └── mainServer.js
</span><span class='line'>└── tests
</span><span class='line'>    └── index.js
</span></code></pre></td></tr></table></div></figure>


<h4>3. Update HTML</h4>

<p>Update &ldquo;mymeteor.html&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;author&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>One Question. Several Answers.<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href=</span><span class="s">&quot;http://netdna.bootstrapcdn.com/bootswatch/3.0.3/yeti/bootstrap.min.css&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    {{&gt; hello}}
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;hello&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h1&gt;</span>Hello World!<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>  {{greeting}}
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;Click&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Your app should now look like this:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/helloworld-redux.png" alt="helloworld-redux" /></p>

<p><a id="test"></a></p>

<h2>Testing Framework</h2>

<p>Since both client and server code are interconnected, we want to be able to write test cases that target both the client and server. <a href="http://arunoda.github.io/laika/">Laika</a> is by far the best framework for this.</p>

<p>For this reason, your tests will run bit slower.</p>

<p>Before installing Laika, make sure you have <a href="http://nodejs.org/">Node.js</a>, <a href="http://phantomjs.org/download.html">PhantomJS</a>, and <a href="http://docs.mongodb.org/manual/installation/">MongoDB</a> installed. Also, run <a href="http://docs.mongodb.org/v2.2/reference/mongod/"><code>mongod</code></a> in a separate terminal window.</p>

<p>Install Laika:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo npm install -g laika
</span></code></pre></td></tr></table></div></figure>


<p>All of our tests will reside in the &ldquo;index.js&rdquo; file within the &ldquo;tests&rdquo; folder.</p>

<p>Now let&rsquo;s start building.</p>

<p><a id="submit"></a></p>

<h2>Users can submit answers</h2>

<h4>1. Client JS</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Answers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s2">&quot;answers&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">addAnswer</span><span class="p">.</span><span class="nx">events</span><span class="p">({</span>
</span><span class='line'>  <span class="s1">&#39;click input.add-answer&#39;</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">answerText</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;answerText&quot;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;addAnswer&quot;</span><span class="p">,</span><span class="nx">answerText</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span> <span class="p">,</span> <span class="nx">answerId</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Added answer with ID: &#39;</span><span class="o">+</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;answerText&quot;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h5>What&rsquo;s going on?</h5>

<p>First, we have a click event, which grabs the value from the input box. This value is then passed to the server side via the <a href="http://docs.meteor.com/#meteor_call"><code>.call()</code></a> - which is used to invoke a method. <code>answerId</code> is then the call back, which is then assigned to the console.log.</p>

<h4>1. Server JS</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Answers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">Collection</span><span class="p">(</span><span class="s2">&quot;answers&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Meteor</span><span class="p">.</span><span class="nx">methods</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">addAnswer</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">answerText</span><span class="p">){</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Adding Answer ...&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">answerId</span> <span class="o">=</span> <span class="nx">Answers</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
</span><span class='line'>      <span class="s1">&#39;answerText&#39;</span> <span class="o">:</span> <span class="nx">answerText</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;submittedOn&#39;</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">answerId</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">answerId</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h5>What&rsquo;s going on?</h5>

<p>On the client side we passed the <code>answerText</code> - inputted value - to the server side. This answer is the added to the MongoDB collection, then we return the answerID, which is handled on the client side.</p>

<p>Notice how we established the Mongo collection on both the client and server.</p>

<h4>3. HTML</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;author&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>One Question. Several Answers.<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href=</span><span class="s">&quot;http://netdna.bootstrapcdn.com/bootswatch/3.0.3/yeti/bootstrap.min.css&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>Add an answer. Or vote.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h3&gt;&lt;em&gt;</span>Question<span class="nt">&lt;/em&gt;</span>: Is the world getting warmer?<span class="nt">&lt;/h3&gt;</span>
</span><span class='line'>    <span class="nt">&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div&gt;</span>
</span><span class='line'>      <span class="c">&lt;!-- if there is an answer, append it to the DOM --&gt;</span>
</span><span class='line'>      {{&gt; addAnswer}}
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;addAnswer&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;textarea</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span> <span class="na">rows=</span><span class="s">&quot;3&quot;</span> <span class="na">name=</span><span class="s">&quot;answerText&quot;</span> <span class="na">id=</span><span class="s">&quot;answerText&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Add Your Answer ..&quot;</span><span class="nt">&gt;&lt;/textarea&gt;</span>
</span><span class='line'>  <span class="nt">&lt;br&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">class=</span><span class="s">&quot;btn-primary add-answer btn-md&quot;</span> <span class="na">value=</span><span class="s">&quot;Add Answer&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>4. Manually Test</h4>

<p>First, your browser view should now look like this:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/part1.png" alt="part1" /></p>

<p>Next, arrange your screen so that you can view both your terminal as well as your browser. Also, open up the JS debug console:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/part1-2.png" alt="part1-2" /></p>

<p>Then, just like in the screenshot above, add an answer. On the client side, you should see the MongoDB ID - i.e., <code>Added answer with ID: ECrTqRQha7vpXu78q</code>, which should match the ID on the server side:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>I20140114-07:38:27.061<span class="o">(</span>-7<span class="o">)</span>? Adding Answer ...
</span><span class='line'>I20140114-07:38:27.340<span class="o">(</span>-7<span class="o">)</span>? ECrTqRQha7vpXu78q
</span></code></pre></td></tr></table></div></figure>


<p><strong>Want to see something cool?</strong> Of course you do.</p>

<p>Open up your browser&rsquo;s console. Let&rsquo;s add an answer:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&gt; Answers.insert<span class="o">({</span>answerText: <span class="s1">&#39;Client Side Console Test!&#39;</span><span class="o">})</span><span class="p">;</span>
</span><span class='line'><span class="s2">&quot;3D9nQYn87gXQX66ha&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You should see the answer appear on the page instantly!!</p>

<h4>5. Automated Test</h4>

<p>Now, add a Laika test by adding the following code to &ldquo;index.js&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="s1">&#39;use strict&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">suite</span><span class="p">(</span><span class="s1">&#39;submitAnswers&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// ensure that -</span>
</span><span class='line'>  <span class="c1">// (1) the &quot;Answers&quot; collection exists</span>
</span><span class='line'>  <span class="c1">// (2) we can connect to the collection</span>
</span><span class='line'>  <span class="c1">// (3) the collection is empty</span>
</span><span class='line'>  <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;server initialization&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">,</span> <span class="nx">server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">server</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">Answers</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="nx">collection</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}).</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">collection</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">done</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// ensure that -</span>
</span><span class='line'>  <span class="c1">// (1) we can add data to the collection</span>
</span><span class='line'>  <span class="c1">// (2) after data is added, we can retrieve it</span>
</span><span class='line'>  <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;server insert : OK&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">,</span> <span class="nx">server</span><span class="p">,</span> <span class="nx">client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">server</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">Answers</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">answerText</span><span class="o">:</span> <span class="s2">&quot;whee!&quot;</span>  <span class="p">});</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">Answers</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="nx">collection</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}).</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">collection</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">done</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">client</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">Answers</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">().</span><span class="nx">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">done</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h5>What&rsquo;s going on here?</h5>

<p>Basically, we are just testing that the Answers collection exists and is accessible. See the inline comments for more info.</p>

<p>You may have noticed that Laika runs a bit slow. Well, that&rsquo;s normal - because Laika creates a new, isolated app and database for each test, and each test is also isolated for the other, so you don&rsquo;t have to worry about dumping the database after each test.</p>

<h5>Run the test</h5>

<p>If all goes well, you should see this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>laika
</span><span class='line'>
</span><span class='line'>  injecting laika...
</span><span class='line'>  loading phantomjs...
</span><span class='line'>  loading initial app pool...
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  submitAnswers
</span><span class='line'>    ✓ server initialization <span class="o">(</span>1517ms<span class="o">)</span>
</span><span class='line'>    ✓ server insert : OK
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="m">2</span> passing <span class="o">(</span>2s<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>  cleaning up injected code
</span></code></pre></td></tr></table></div></figure>


<p>Congrats! You just wrote your first test!</p>

<blockquote><p>If you have not initialized a Git repo yet, go ahead and do this now. Then commit the code.</p></blockquote>

<p><a id="submitted"></a></p>

<h2>Users can see all submitted answers</h2>

<h4>1. Client JS</h4>

<p>Add the following template to pull out the data from the collection and sort in descending order.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">return</span> <span class="nx">Answers</span><span class="p">.</span><span class="nx">find</span><span class="p">({},{</span><span class="nx">sort</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;submittedOn&#39;</span><span class="o">:-</span><span class="mi">1</span><span class="p">}});</span>
</span></code></pre></td></tr></table></div></figure>


<h4>2. HTML</h4>

<p>Add the templates to the HTML file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;author&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>One Question. Several Answers.<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href=</span><span class="s">&quot;http://netdna.bootstrapcdn.com/bootswatch/3.0.3/yeti/bootstrap.min.css&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>Add an answer. Or vote.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h3&gt;&lt;em&gt;</span>Question<span class="nt">&lt;/em&gt;</span>: Is the world getting warmer?<span class="nt">&lt;/h3&gt;</span>
</span><span class='line'>    <span class="nt">&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div&gt;</span>
</span><span class='line'>      <span class="c">&lt;!-- if there is an answer, append it to the DOM --&gt;</span>
</span><span class='line'>      {{&gt; addAnswer}}
</span><span class='line'>      {{&gt; answers}}
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;addAnswer&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;textarea</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span> <span class="na">rows=</span><span class="s">&quot;3&quot;</span> <span class="na">name=</span><span class="s">&quot;answerText&quot;</span> <span class="na">id=</span><span class="s">&quot;answerText&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Add Your Answer ..&quot;</span><span class="nt">&gt;&lt;/textarea&gt;</span>
</span><span class='line'>  <span class="nt">&lt;br&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">class=</span><span class="s">&quot;btn-primary add-answer btn-md&quot;</span> <span class="na">value=</span><span class="s">&quot;Add Answer&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;answers&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;br&gt;</span>
</span><span class='line'>  <span class="nt">&lt;br&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h2&gt;</span>All Questions<span class="nt">&lt;/h2&gt;</span>
</span><span class='line'>  {{#each items}}
</span><span class='line'>    {{&gt; answer}}
</span><span class='line'>  {{/each}}
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;answer&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;lead&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      {{answerText}}
</span><span class='line'>      <span class="nt">&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/p&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. Manually Test</h4>

<p>You should see all of the submitted answers:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/part2.png" alt="part2" /></p>

<p>Go ahead and add new answers. They should immediately appear.</p>

<p>As far as automated testing goes, we are already testing this with this code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">client</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">Answers</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">().</span><span class="nx">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">done</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>Commit your code.</p>

<p><a id="vote"></a></p>

<h2>Users can up or down vote answers</h2>

<p>Let&rsquo;s add some voting capabilities. Think about what we need to add for this.</p>

<ol>
<li>Update collection to store votes</li>
<li>Update HTML to add vote buttons</li>
<li>Event handler for when the user clicks a button so that the collection is updated</li>
</ol>


<h4>1. Server JS</h4>

<p>Add the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">incrementYesVotes</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">answerID</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">answerID</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">Answers</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">answerID</span><span class="p">,{</span><span class="nx">$inc</span> <span class="o">:</span> <span class="p">{</span><span class="s1">&#39;yes&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">}});</span>
</span><span class='line'><span class="p">},</span>
</span><span class='line'><span class="nx">incrementNoVotes</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">answerID</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">answerID</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">Answers</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">answerID</span><span class="p">,{</span><span class="nx">$inc</span> <span class="o">:</span> <span class="p">{</span><span class="s1">&#39;no&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">}});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This utilizes Meteor&rsquo;s collection update to increment the counter.</p>

<h4>2. Client JS</h4>

<p>Add the event handler:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">answer</span><span class="p">.</span><span class="nx">events</span><span class="p">({</span>
</span><span class='line'>  <span class="s1">&#39;click&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;selected_answer&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click a.yes&#39;</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">answerId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selected_answer&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;updating yes count for answerId &#39;</span><span class="o">+</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;incrementYesVotes&quot;</span><span class="p">,</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click a.no&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">answerId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selected_answer&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;updating no count for answerId &#39;</span><span class="o">+</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">Meteor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;incrementNoVotes&quot;</span><span class="p">,</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. HTML</h4>

<p>Update the <code>answer</code> template:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;answer&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;lead&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      {{answerText}}
</span><span class='line'>      <span class="nt">&lt;br&gt;</span>
</span><span class='line'>      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;btn btn-xs btn-success yes&quot;</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon-thumbs-up&quot;</span><span class="nt">&gt;&lt;/i&gt;</span> Yes {{yes}}<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;btn btn-xs btn-primary no&quot;</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon-thumbs-down&quot;</span><span class="nt">&gt;&lt;/i&gt;</span> No {{no}}<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/p&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. Manually Test</h4>

<p>You should see Yes and No buttons below the answers:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/part3.png" alt="part3" /></p>

<p>Test it out:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/part3-2.png" alt="part3-2" /></p>

<h4>4. Automated Test</h4>

<p>Add the following code to &ldquo;index.js&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">suite</span><span class="p">(</span><span class="s1">&#39;addVotes&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// ensure that -</span>
</span><span class='line'>  <span class="c1">// (1) we can add data to the collection</span>
</span><span class='line'>  <span class="c1">// (2) after data is added, we can retrieve it</span>
</span><span class='line'>  <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;server insert votes : OK&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">,</span> <span class="nx">server</span><span class="p">,</span> <span class="nx">client</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">server</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">Answers</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="nx">answerText</span><span class="o">:</span> <span class="s2">&quot;wheeeeeeeeeee!&quot;</span><span class="p">});</span>
</span><span class='line'>      <span class="nx">Answers</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span><span class="nx">answerText</span><span class="o">:</span> <span class="s2">&quot;wheeeeeeeeeee!&quot;</span><span class="p">},{</span><span class="nx">$inc</span> <span class="o">:</span> <span class="p">{</span><span class="s1">&#39;yes&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">}});</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">voteCollection</span> <span class="o">=</span> <span class="nx">Answers</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">fetch</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="nx">voteCollection</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}).</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">voteCollection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// console.log(collection[0].yes)</span>
</span><span class='line'>      <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">voteCollection</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">yes</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">done</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h5>What&rsquo;s going on here?</h5>

<p>Similar to the last test, we are just testing that the collection exists and that it returns certain data. This time, though, we are not just testing that the collection exists, but that the <code>yes</code> key contains a value of 1.</p>

<h5>Run the test</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>laika
</span><span class='line'>
</span><span class='line'>  injecting laika...
</span><span class='line'>  loading phantomjs...
</span><span class='line'>  loading initial app pool...
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  submitAnswers
</span><span class='line'>    ✓ server initialization <span class="o">(</span>1882ms<span class="o">)</span>
</span><span class='line'>    ✓ server insert : OK <span class="o">(</span>2957ms<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>  addVotes
</span><span class='line'>    ✓ server insert votes : OK <span class="o">(</span>3105ms<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="m">3</span> passing <span class="o">(</span>8s<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>  cleaning up injected code
</span></code></pre></td></tr></table></div></figure>


<p>Commit your code!</p>

<p><a id="twitter"></a></p>

<h2>Users can login via Twitter</h2>

<p>Remember when we added these two packages-</p>

<ol>
<li><code>accounts-ui</code></li>
<li><code>accounts-twitter</code></li>
</ol>


<p>-well, let&rsquo;s go ahead and use them.</p>

<h4>1. Update HTML</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>Add an answer. Or vote.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div&gt;</span>
</span><span class='line'>      {{loginButtons}}
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h3&gt;&lt;em&gt;</span>Question<span class="nt">&lt;/em&gt;</span>: Is the world getting warmer?<span class="nt">&lt;/h3&gt;</span>
</span><span class='line'>    <span class="nt">&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div&gt;</span>
</span><span class='line'>      <span class="c">&lt;!-- if there is an answer, append it to the DOM --&gt;</span>
</span><span class='line'>      {{&gt; addAnswer}}
</span><span class='line'>      {{&gt; answers}}
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Check your browser. You should see the &ldquo;Configure Twitter Login&rdquo; button. Go ahead and click it:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/oauth.png" alt="oauth" /></p>

<p>Wow. This tells you <em>exactly</em> how to setup your app on Twitter for logging via Oauth. Follow the instructions to create the app, then copy and paste the consumer key and consumer secret into the window on the Meteor app.</p>

<p>Next, test logging in. If all went well you should see:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/oauth2.png" alt="oauth2" /></p>

<blockquote><p>If you need to add a different Twitter app to authenticate with you must drop the <code>meteor_accounts_loginServiceConfiguration</code> collection from MongoDB - <code>db.meteor_accounts_loginServiceConfiguration.drop()</code></p></blockquote>

<h4>4. Automated Test</h4>

<p>Since the Twitter login is part of a pre-written package, we do not need to do any unit tests. In general, unit tests should be reserved to code that you have written. Other people&rsquo;s code should be tested within the scope of a functional test, which I cannot figure out how to do with Laika. You could use Selenium or PhantomJS here, but I think just the manual testing is fine for now. The Meteor team really needs to develop an internal testing solution.</p>

<p>Commit your code. Take a breath. Move on.</p>

<p><a id="loggedin"></a></p>

<h2>Users can only answer or vote if they are logged in</h2>

<p>Finally, let&rsquo;s add some restrictions so that a user must be logged in before adding answers or voting.</p>

<h4>1. Client JS</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Template</span><span class="p">.</span><span class="nx">answer</span><span class="p">.</span><span class="nx">events</span><span class="p">({</span>
</span><span class='line'>  <span class="s1">&#39;click&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Session</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;selected_answer&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click a.yes&#39;</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">userId</span><span class="p">()){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">answerId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selected_answer&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;updating yes count for answerId &#39;</span><span class="o">+</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">Meteor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;incrementYesVotes&quot;</span><span class="p">,</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s1">&#39;click a.no&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">Meteor</span><span class="p">.</span><span class="nx">userId</span><span class="p">()){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">answerId</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;selected_answer&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;updating no count for answerId &#39;</span><span class="o">+</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">Meteor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;incrementNoVotes&quot;</span><span class="p">,</span><span class="nx">answerId</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h4>2. Server JS</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">answerId</span> <span class="o">=</span> <span class="nx">Answers</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
</span><span class='line'>  <span class="s1">&#39;answerText&#39;</span> <span class="o">:</span> <span class="nx">answerText</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;submittedOn&#39;</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
</span><span class='line'>  <span class="s1">&#39;submittedBy&#39;</span> <span class="o">:</span> <span class="nx">Meteor</span><span class="p">.</span><span class="nx">userId</span><span class="p">()</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. HTML</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;author&quot;</span> <span class="na">content=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>One Question. Several Answers.<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href=</span><span class="s">&quot;http://netdna.bootstrapcdn.com/bootswatch/3.0.3/yeti/bootstrap.min.css&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>Add an answer. Or vote.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    {{#if currentUser}}
</span><span class='line'>      {{loginButtons}}
</span><span class='line'>    {{/if}}
</span><span class='line'>    <span class="nt">&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h3&gt;&lt;em&gt;</span>Question<span class="nt">&lt;/em&gt;</span>: Is the world getting warmer?<span class="nt">&lt;/h3&gt;</span>
</span><span class='line'>    <span class="nt">&lt;br&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>
</span><span class='line'>        {{#if currentUser}}
</span><span class='line'>          {{&gt; addAnswer}}
</span><span class='line'>          {{&gt; answers}}
</span><span class='line'>        {{/if}}
</span><span class='line'>        {{#unless currentUser}}
</span><span class='line'>          {{&gt; login}}
</span><span class='line'>          {{loginButtons}}
</span><span class='line'>        {{/unless}}
</span><span class='line'>      <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;addAnswer&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;textarea</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span> <span class="na">rows=</span><span class="s">&quot;3&quot;</span> <span class="na">name=</span><span class="s">&quot;answerText&quot;</span> <span class="na">id=</span><span class="s">&quot;answerText&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Add Your Answer ..&quot;</span><span class="nt">&gt;&lt;/textarea&gt;</span>
</span><span class='line'>  <span class="nt">&lt;br&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">class=</span><span class="s">&quot;btn-primary add-answer btn-md&quot;</span> <span class="na">value=</span><span class="s">&quot;Add Answer&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;answers&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;br&gt;</span>
</span><span class='line'>  <span class="nt">&lt;br&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h2&gt;</span>All Questions<span class="nt">&lt;/h2&gt;</span>
</span><span class='line'>  {{#each items}}
</span><span class='line'>    {{&gt; answer}}
</span><span class='line'>  {{/each}}
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;answer&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;lead&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      {{answerText}}
</span><span class='line'>      <span class="nt">&lt;br&gt;</span>
</span><span class='line'>      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;btn btn-xs btn-success yes {{#unless currentUser}}disabled{{/unless}}&quot;</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon-thumbs-up&quot;</span><span class="nt">&gt;&lt;/i&gt;</span> Yes {{yes}}<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;btn btn-xs btn-primary no {{#unless currentUser}}disabled{{/unless}}&quot;</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon-thumbs-down&quot;</span><span class="nt">&gt;&lt;/i&gt;</span> No {{no}}<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/p&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">&quot;login&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;h4&gt;</span>Sign in using Twitter to submit new questions or to vote on existing questions.<span class="nt">&lt;/h4&gt;</span>
</span><span class='line'><span class="nt">&lt;/template&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h5>What&rsquo;s going on here?</h5>

<ol>
<li><code>if(Meteor.userId()){}</code> prevents a user from voting if they are not logged in, but only on the JS side. In other words, the user can still click the button; it&rsquo;s just nothing will happen if they do.</li>
<li><code>'submittedBy' : Meteor.userId()</code> adds the logged in user to the collection</li>
<li><code>{{#unless currentUser}}disabled{{/unless}}</code> disables the yes or no button. Now the it can&rsquo;t even be clicked unless the user is logged in.</li>
<li><code>{{#if currentUser}} ... {{/if}}</code> and <code>{{#unless currentUser}} ... {{/unless}}</code> are used to display certain templates if the user is logged in or not.</li>
</ol>


<h4>4. Manual Test</h4>

<p>Open your browser. If you&rsquo;re logged in, go ahead and log out. You should see this:</p>

<p><img src="https://raw.github.com/mjhea0/meteor-in-action/master/images/loggedout.png" alt="loggedout" /></p>

<p>Now, before logging in to test. Let&rsquo;s dump the answers collection so that each record in the collection has a user associated with it. To do this, make sure your meteor app is running, then open a new terminal window and navigate to your app&rsquo;s project root.</p>

<p>Follow these commands to dump the collection:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>meteor mongo
</span><span class='line'>MongoDB shell version: 2.4.8
</span><span class='line'>connecting to: 127.0.0.1:3002/meteor
</span><span class='line'>meteor:PRIMARY&gt; show dbs<span class="p">;</span>
</span><span class='line'><span class="nb">local </span>0.0625GB
</span><span class='line'>meteor  0.0625GB
</span><span class='line'>meteor:PRIMARY&gt; use meteor<span class="p">;</span>
</span><span class='line'>switched to db meteor
</span><span class='line'>meteor:PRIMARY&gt; show collections<span class="p">;</span>
</span><span class='line'>answers
</span><span class='line'>meteor_accounts_loginServiceConfiguration
</span><span class='line'>questions
</span><span class='line'>system.indexes
</span><span class='line'>users
</span><span class='line'>meteor:PRIMARY&gt; db.answers.drop<span class="o">()</span>
</span><span class='line'><span class="nb">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>Back on your browser, go ahead and log back in. Add an answer.</p>

<p>Finally, jump back to the mongo shell:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>meteor:PRIMARY&gt; show collections<span class="p">;</span>
</span><span class='line'>answers
</span><span class='line'>meteor_accounts_loginServiceConfiguration
</span><span class='line'>questions
</span><span class='line'>system.indexes
</span><span class='line'>users
</span><span class='line'>meteor:PRIMARY&gt; db.answers.find<span class="o">()</span>
</span><span class='line'><span class="o">{</span> <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;cbWebazW8eehJkaXL&quot;</span>, <span class="s2">&quot;answerText&quot;</span> : <span class="s2">&quot;This is my first test while logged in.&quot;</span>, <span class="s2">&quot;no&quot;</span> : 2, <span class="s2">&quot;submittedBy&quot;</span> : <span class="s2">&quot;Ex2bHmCgkygNbByEc&quot;</span>, <span class="s2">&quot;submittedOn&quot;</span> : ISODate<span class="o">(</span><span class="s2">&quot;2014-01-14T20:07:53.080Z&quot;</span><span class="o">)</span>, <span class="s2">&quot;yes&quot;</span> : <span class="m">2</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Success! There is a key/value pair for the user - <code>"submittedBy" : "Ex2bHmCgkygNbByEc"</code>.</p>

<p><a id="insecure"></a></p>

<h2>Remove insecure packages</h2>

<p>All Meteor applications have a package called Insecure pre-installed. This handy little package gives the client the ability to interact with the database, as you saw before. While this may be handy for prototyping you always want to remove it for production applications.</p>

<p>To remove, just run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>meteor remove insecure
</span></code></pre></td></tr></table></div></figure>


<h4>1. Manually Test</h4>

<p>Manually test this on your end. With the Meteor server running and your browser open, try to insert an answer in the console. Make sure that the user is logged in.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&gt; Answers.insert<span class="o">({</span>answerText: <span class="s1">&#39;Client Console Test!&#39;</span><span class="o">})</span>
</span><span class='line'><span class="s2">&quot;oeYhZMmXyBjivJ5uM&quot;</span>
</span><span class='line'>insert failed: Access denied
</span></code></pre></td></tr></table></div></figure>


<p>You should the see above insertion error. Also, you know that it&rsquo;s not working if the answer did not get immediately added to the page.</p>

<p>Finally, you can look in Mongo, just to be sure. Open a new window in your terminal, navigate to your &ldquo;mymeteor&rdquo; directory, then type the following commands:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>meteor mongo
</span><span class='line'>MongoDB shell version: 2.4.8
</span><span class='line'>connecting to: 127.0.0.1:3002/meteor
</span><span class='line'>meteor:PRIMARY&gt; show dbs<span class="p">;</span>
</span><span class='line'><span class="nb">local </span>0.0625GB
</span><span class='line'>meteor  0.0625GB
</span><span class='line'>meteor:PRIMARY&gt; use meteor<span class="p">;</span>
</span><span class='line'>switched to db meteor
</span><span class='line'>meteor:PRIMARY&gt; show collections<span class="p">;</span>
</span><span class='line'>answers
</span><span class='line'>meteor_accounts_loginServiceConfiguration
</span><span class='line'>questions
</span><span class='line'>system.indexes
</span><span class='line'>users
</span></code></pre></td></tr></table></div></figure>


<p>Now search the collection:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>meteor:PRIMARY&gt; db.answers.find<span class="o">({</span>answerText: <span class="s1">&#39;Client Console Test!&#39;</span><span class="o">})</span>
</span><span class='line'>meteor:PRIMARY&gt;
</span></code></pre></td></tr></table></div></figure>


<p>This shouldn&rsquo;t find anything.</p>

<p><a id="deployment"></a></p>

<h2>Deployment</h2>

<p>Although there are a number of deployment options, pushing your new app to the Meteor test servers is by far the easiest. Simply run the command: <code>meteor deploy &lt;YOUR-APP-NAME-HERE&gt;</code>.</p>

<p>So -</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>meteor deploy answers
</span></code></pre></td></tr></table></div></figure>


<p>Check it out at <a href="http://answers.meteor.com/">http://answers.meteor.com/</a>.</p>

<blockquote><p>The Meteor servers are for <strong>testing</strong> only; they are not meant for apps in production.</p></blockquote>

<p>Don&rsquo;t forget to commit!</p>

<p><a id="next"></a></p>

<h2>What&rsquo;s next?</h2>

<ol>
<li>Deploy to Heroku</li>
<li>Setup Selenium Tests</li>
<li>Add additional functionality</li>
</ol>


<p><a id="conclusion"></a></p>

<h2>Conclusion</h2>

<p>That&rsquo;s it. Give me some feedback. In the coming weeks, I&rsquo;ll be deploying an app into production. Stay tuned.</p>

<p>Grab the code from the repo <a href="https://github.com/mjhea0/meteor-in-action">here</a></p>
</div>


  <footer>
    <p class="meta">
      
  



  <span class="byline author vcard">Authored by <span class="fn">
  
    Michael Herman
  
  </span></span>


      




<time class='entry-date' datetime='2014-01-29T10:51:00-07:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:51 am</span></time>
      
      

<span class="categories">
  
    <a class='category' href='/blog/categories/meteor/'>meteor</a>
  
</span>


    </p>
    
      <div class="sharing">
<!--   
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mherman.org/blog/2014/01/29/meteor-dot-js-in-action-create-an-app-test-with-laika/" data-via="" data-counturl="http://mherman.org/blog/2014/01/29/meteor-dot-js-in-action-create-an-app-test-with-laika/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
   -->
  <br>
  <!-- AddThis Button BEGIN -->
  <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
  <a class="addthis_button_preferred_1"></a>
  <a class="addthis_button_preferred_2"></a>
  <a class="addthis_button_preferred_3"></a>
  <a class="addthis_button_preferred_4"></a>
  <a class="addthis_button_compact"></a>
  <a class="addthis_counter addthis_bubble_style"></a>
  </div>
  <script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50e5f1cc35ad077d"></script>
  <!-- AddThis Button END -->
  <br>
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/01/23/so-you-want-be-an-entrepreneur/" title="Previous Post: So you want be an Entrepreneur?">&laquo; So you want be an Entrepreneur?</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/02/16/getting-started-with-node/" title="Next Post: Getting Started with Node">Getting Started with Node &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


</div>

    </div>
  </div>
  <footer role="contentinfo"><div>
  <span>Copyright &copy; 2016 - Michael Herman</span><br>
  <a href="https://github.com/mjhea0"><i class="fa fa-github-square" style="font-size:2em" aria-hidden="true"></i></a>
  <a href="https://twitter.com/mikeherman"><i class="fa fa-twitter-square" style="font-size:2em" aria-hidden="true"></i></a>
  <a href="http://www.linkedin.com/pub/michael-herman/3b/a94/4"><i class="fa fa-linkedin-square" style="font-size:2em" aria-hidden="true"></i></a>
  <a href="http://www.youtube.com/hermanmu"><i class="fa fa-youtube-square" style="font-size:2em" aria-hidden="true"></i></a>
</div>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'michaelherman';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mherman.org/blog/2014/01/29/meteor-dot-js-in-action-create-an-app-test-with-laika/';
        var disqus_url = 'http://mherman.org/blog/2014/01/29/meteor-dot-js-in-action-create-an-app-test-with-laika/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
