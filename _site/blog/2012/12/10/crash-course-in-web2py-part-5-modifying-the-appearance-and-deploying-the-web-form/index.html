<!DOCTYPE html>
<html lang="en">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>Crash Course in web2py (part 5 - modifying the appearance and deploying the web form)</title>
  <meta name="description" content="You made it. In this final tutorial I’ll show you how to easily modify the form’s appearance, and we’ll deploy the app to PythonAnywhere.">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/blog/2012/12/10/crash-course-in-web2py-part-5-modifying-the-appearance-and-deploying-the-web-form/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Michael Herman" href="http://localhost:4000/feed.xml">

  <link rel="icon" type="image/png" href="/favicon.png">


  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Crash Course in web2py (part 5 - modifying the appearance and deplo...">
  <meta name="twitter:description" content="You made it. In this final tutorial I’ll show you how to easily modify the form’s appearance, and we’ll deploy the app to PythonAnywhere.">
  
  

  <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Bitter:400,700,400italic:latin' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  
</head>


  <link rel="stylesheet" href="/assets/hello.css">

  <body>

    <header class="site-header">

  <div class="color-bar">
    <div class="bar bar1"></div>
    <div class="bar bar2"></div>
    <div class="bar bar3"></div>
    <div class="bar bar4"></div>
    <div class="bar bar5"></div>
    <div class="bar bar6"></div>
  </div>

  <div class="wrapper">

    <a class="site-title" href="/">Michael Herman</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/">Blog</a>
      
        
        <a class="page-link" href="/about">About</a>
      
        
        <a class="page-link" href="/talks">Talks</a>
      
        
        <a class="page-link" href="/feed.xml">RSS</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">Crash Course in web2py (part 5 - modifying the appearance and deploying the web form)</h1>
    
    <p class="post-meta"><time datetime="2012-12-10T07:39:00-07:00" itemprop="datePublished">Dec 10, 2012</time> • 
  
  
    
  
    
  
    
      <a href="/categories/python/">python</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
      <a href="/categories/web2py/">web2py</a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>You made it. In this final tutorial I’ll show you how to easily modify the form’s appearance, and we’ll deploy the app to PythonAnywhere.</p>

<p><em>Assumptions:</em></p>

<ol>
  <li>You have web2py already installed =&gt; <a href="http://mherman.org/blog/2012/11/27/crash-course-in-web2py-part-1/">part 1</a></li>
  <li>You created the skeleton web form =&gt; <a href="http://mherman.org/blog/2012/12/01/crash-course-in-web2py-part-2-web-forms/">part 2</a></li>
  <li>You added data validation (with the help of Han Solo) =&gt; <a href="http://mherman.org/blog/2012/12/06/crash-course-in-web2py-part-3-form-validation/">part 3</a></li>
  <li>You learned how to easily add CRUD functions to manage records =&gt; <a href="http://mherman.org/blog/2012/12/09/crash-course-in-web2py-part-4-managing-form-records/">part 4</a></li>
</ol>

<p>Let’s get going …</p>

<p>Launch the server. -&gt; Go to the admin interface. -&gt; Edit the “form” application.</p>

<p>So, by default web2py utilizes the <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a> front-end framework, which makes updating the layout and appearance easy.</p>

<h2 class="no_toc" id="contents">Contents</h2>

<ul id="markdown-toc">
  <li><a href="#download-new-layout-plugin" id="markdown-toc-download-new-layout-plugin">Download New Layout Plugin</a></li>
  <li><a href="#update-css" id="markdown-toc-update-css">Update CSS</a></li>
  <li><a href="#deploy" id="markdown-toc-deploy">Deploy</a></li>
  <li><a href="#recap" id="markdown-toc-recap">Recap</a></li>
</ul>

<h2 id="download-new-layout-plugin">Download New Layout Plugin</h2>

<p>First, go to the web2py layout plugin <a href="http://web2py.com/layouts">page</a> to find a layout that you like. In this example, I used <a href="http://web2py.com/layouts/static/plugin_layouts/layouts/KeepitSimple/index.html">KeepitSimple</a>. Once you find one, go ahead and download the .w2p file.</p>

<p>Back on the admin page for the form, scroll to the bottom of the page, and upload the .w2p file beneath the Plugins section. Now, click the link for plugin_layouts and copy the name of the new file including the full path- <em>plugin_layouts/layouts/KeepitSimple.html</em>. Now, edit the display_your_form.html file and paste the new .html file in the very first line of the code, replacing layout.html-</p>

<p><img src="http://www.backwardsteps.com/uploads/2012-12-09_2303.png" alt="web2py" /></p>

<p>Next, I’m going to remove the <em>Web Form</em> title between the h1 tags, remove the line breaks, and clean up the instructions. I’m also going to remove the <em>Submitted</em>, <em>Accepted</em>, and, <em>Errors</em>  sections, as the user does not need to see all that information. So the final code looks like this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{{extend 'plugin_layouts/layouts/KeepitSimple.html'}}
<span class="nt">&lt;p&gt;</span>Please enter your first name, last name, and email address - thanks!<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;h2&gt;</span>Inputs:<span class="nt">&lt;/h2&gt;</span>
{{=form}}
</code></pre></div></div>

<p>Okay, now let’s edit the <em>KeepitSimple html</em> file:</p>

<p>First change the header div found in the middle of the page - “Welcome. Please register to access your services.” (I also surrounded it in <code class="highlighter-rouge">&lt;center&gt;</code> tags)</p>

<p>Add the following code to the header, just below the style.css -</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{{response.files.append(URL(request.application,'static','css/bootstrap.min.css'))}}
</code></pre></div></div>

<p>Then remove these lines of code-</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{{try:}}{ {=auth.navbar(action=URL('default','user'))}}{{ except:pass}}
{{=MENU(response.menu,_class='web2py-menu')}}
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"footer"</span><span class="nt">&gt;</span><span class="ni">&amp;copy;</span>2007 Keep it Simple <span class="ni">&amp;nbsp;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"separator"</span>
<span class="err">|</span>
<span class="err">&lt;/</span><span class="na">span</span><span class="nt">&gt;</span>
<span class="ni">&amp;nbsp;</span> Design by
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://www.realitysoftware.ca"</span> <span class="na">title=</span><span class="s">"Website Design"</span><span class="nt">&gt;</span>
Reality Software
<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h2 id="update-css">Update CSS</h2>

<p>Your form should look much cleaner now. It’s a bit bare, but you can liven it up with your own HTML. Now, let’s add some changes to the CSS.</p>

<p>Again, since web2py uses the Twitter Bootstrap, you can make CSS changes quickly. Navigate to <a href="http://bootswatch.com/">Bootswatch</a>. Here, you can find various CSS themes to play with. In this example, I’m going to use Spacelab.</p>

<p>Now, what you need to do is view the <em>bootstrap.min.css</em> file by clicking download and then selecting the file. It should open in your browser. Copy all the text. Return to your web2py admin. Scroll down to the static files, click the CSS folder, edit the boootstrap.min.css file-</p>

<p><img src="http://www.backwardsteps.com/uploads/2012-12-10_0824.png" alt="web2py" /></p>

<p>-and then delete all the current CSS and paste in the CSS that you copied before from the Spacelab theme. Refresh your form @ <a href="http://127.0.0.1:8000/form/default/display_your_form.html">http://127.0.0.1:8000/form/default/display_your_form.html</a> and test it again to make sure nothing broke.</p>

<p>Oh - and if you want, you can edit the layout/appearance of the all_records page as well. I trust that you can figure out how to do that by now. If not - Try anyway, and if you fail, Google to find the answer. You’ll learn better that way.</p>

<p>If all looks well, it’s time to deploy!</p>

<h2 id="deploy">Deploy</h2>

<p>I’ll go over this quick since I covered this in <a href="http://mherman.org/blog/2012/11/27/crash-course-in-web2py-part-1/">detail</a> in the first tutorial.</p>

<ol>
  <li>Go back to the admin page (<a href="http://127.0.0.1:8000/admin/default/site">http://127.0.0.1:8000/admin/default/site</a>) and click Pack All. Save the w2p-package to your computer.</li>
  <li>Fire up <a href="https://www.pythonanywhere.com/">PythonAnywhere</a>.</li>
  <li>Once logged in, click <em>Web</em>, <em>Replace with a new web app</em>, then click the button for web2py.</li>
  <li>Enter an admin password. Click Next.</li>
  <li>Next, head on over to the admin interface - https://mjhea9.pythonanywhere.com/admin/default/index (don’t forget to use your own user name and add the https:) - which should look familiar (it better!). Enter your password.</li>
  <li>On the right side of the page, under the <em>Upload and install packed application section</em>, upload the w2p file you saved. Enter a name for your app (“form”). Click Install.</li>
  <li>Check out your form.</li>
</ol>

<p><img src="http://www.backwardsteps.com/uploads/2012-12-10_0917.png" alt="web2py" /></p>

<p>Now just test it out to make sure it all works. Make sure all the errors/validators are working and then add a new record. One thing you do need to change is the default for generic view. You can read more about it <a href="http://web2py.com/books/default/chapter/29/10#Generic-views">here</a>. Open up db.py and scroll down to line 28. You need to remove the if statement, so the line will look just like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="o">.</span><span class="n">generic_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'*'</span><span class="p">]</span>
</code></pre></div></div>

<p>Now, make sure you can access the <em>grid</em> page and edit, update, and delete some records.</p>

<p>One change that does need to be made is to add the requirement <em>IS_EMAIL()</em> to the email validation field to the db.py file; otherwise, you can submit email addresses that do not follow the conventional format. The final code looks like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">db</span> <span class="o">=</span> <span class="n">DAL</span><span class="p">(</span><span class="s">'sqlite://webform.sqlite'</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">define_table</span><span class="p">(</span><span class="s">'register'</span><span class="p">,</span>
	<span class="n">Field</span><span class="p">(</span><span class="s">'first_name'</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="n">IS_NOT_EMPTY</span><span class="p">(),</span> <span class="n">IS_ALPHANUMERIC</span><span class="p">()]),</span>
	<span class="n">Field</span><span class="p">(</span><span class="s">'last_name'</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="n">IS_NOT_EMPTY</span><span class="p">(),</span> <span class="n">IS_ALPHANUMERIC</span><span class="p">()]),</span>
	<span class="n">Field</span><span class="p">(</span><span class="s">'email'</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="n">IS_NOT_EMPTY</span><span class="p">(),</span> <span class="n">IS_EMAIL</span><span class="p">()]),</span>
	<span class="n">Field</span><span class="p">(</span><span class="s">'email_validate'</span><span class="p">,</span><span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="n">IS_EMAIL</span><span class="p">(),</span> <span class="n">IS_EQUAL_TO</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="nb">vars</span><span class="o">.</span><span class="n">email</span><span class="p">)]))</span>
<span class="n">db</span><span class="o">.</span><span class="n">register</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">requires</span><span class="o">=</span><span class="n">IS_NOT_IN_DB</span><span class="p">(</span><span class="n">db</span><span class="p">,</span><span class="s">'register.email'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="recap">Recap</h2>

<p>And you’re done. So - what all did we do?</p>

<ul>
  <li><a href="http://mherman.org/blog/2012/11/27/crash-course-in-web2py-part-1/">Part 1</a>: You learned how to install web2py on your local computer and deploy a basic app on a cloud platform</li>
  <li><a href="http://mherman.org/blog/2012/12/01/crash-course-in-web2py-part-2-web-forms/">Part 2</a>: You learned about Model View Control (MVC) architecture and created a skeleton web form</li>
  <li><a href="http://mherman.org/blog/2012/12/06/crash-course-in-web2py-part-3-form-validation/">Part 3</a>: You added data validation to the form</li>
  <li><a href="http://mherman.org/blog/2012/12/09/crash-course-in-web2py-part-4-managing-form-records/">Part 4</a>: You learned how to manage records in the database</li>
  <li><a href="http://mherman.org/blog/2012/12/10/crash-course-in-web2py-part-5-modifying-the-appearance-and-deploying-the-web-form/">Part 5</a>: You learned how to modify the appearance and layout of the form</li>
</ul>

<p>Congrats!</p>

<p>What’s next? Think about what you can do with this info.</p>

<ul>
  <li>Keep practicing.</li>
  <li>Build something else.</li>
  <li>Make some money</li>
  <li>And have fun!</li>
</ul>

<p>Thanks for reading. Cheers.</p>

<p>You can find the new code for db.py, display_your_form.html, and default.py, as well as all the files and the final packed app (.w2p) <a href="https://github.com/mjhea0/web2py/tree/master/form%20-%20part%204">here</a>.</p>

  </div>

  <!-- addthis -->
  
    <div class="sharing">
  <br>
  <!-- AddThis Button BEGIN -->
  <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
    <a class="addthis_button_preferred_1"></a>
    <a class="addthis_button_preferred_2"></a>
    <a class="addthis_button_preferred_3"></a>
    <a class="addthis_button_preferred_4"></a>
    <a class="addthis_button_compact"></a>
    <a class="addthis_counter addthis_bubble_style"></a>
  </div>
  <script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50e5f1cc35ad077d"></script>
  <!-- AddThis Button END -->
  <br>
</div>

  

  <!-- disqus -->
  
    <div id="disqus_thread"></div>

<script>
  var disqus_config = function () {
    this.page.url = 'http://localhost:4000/blog/2012/12/10/crash-course-in-web2py-part-5-modifying-the-appearance-and-deploying-the-web-form/';
    this.page.identifier = 'http://localhost:4000/blog/2012/12/10/crash-course-in-web2py-part-5-modifying-the-appearance-and-deploying-the-web-form/';
  };

  (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//' + 'michaelherman' + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  


</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      




<div>
  <hr>
  <p>
    <span>Copyright &copy; 2018 - Michael Herman</span>
    <br>
    <small>Questions? michael at mherman dot org</small><br>
    <small><a href="#">Back to top</a></small>
    <br>
    <span>
      <a href="https://github.com/mjhea0"><i class="fa fa-github-square" style="font-size:2em" aria-hidden="true"></i></a>
      <a href="https://twitter.com/mikeherman"><i class="fa fa-twitter-square" style="font-size:2em" aria-hidden="true"></i></a>
      <a href="http://www.linkedin.com/pub/michael-herman/3b/a94/4"><i class="fa fa-linkedin-square" style="font-size:2em" aria-hidden="true"></i></a>
      <a href="http://www.youtube.com/hermanmu"><i class="fa fa-youtube-square" style="font-size:2em" aria-hidden="true"></i></a>
    </span>
  </p>
</div>

    </p>

  </div>

</footer>


  </body>

  <script type="text/javascript" src="/assets/hello.js"></script>

</html>
