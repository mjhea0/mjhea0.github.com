<div class="highlight"><pre><span class="c">#!/bin/sh</span>

<span class="nv">fails</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

<span class="k">function</span> inspect<span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$1</span> -ne <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nv">fails</span><span class="o">=</span><span class="s2">&quot;${fails} $2&quot;</span>
  <span class="k">fi</span>
<span class="o">}</span>

docker-compose run users-service npm <span class="nb">test</span>
inspect <span class="nv">$?</span> users-service

docker-compose run movies-service npm <span class="nb">test</span>
inspect <span class="nv">$?</span> movies-service

testcafe firefox tests/**/*.js
inspect <span class="nv">$?</span> e2e

<span class="k">if</span> <span class="o">[[</span> -n <span class="s2">&quot;${fails}&quot;</span> <span class="o">]]</span><span class="p">;</span>
  <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Tests failed: ${fails}&quot;</span>
    <span class="nb">exit </span>1
  <span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;Tests passed!&quot;</span>
    <span class="nb">exit </span>0
<span class="k">fi</span>
</pre></div>