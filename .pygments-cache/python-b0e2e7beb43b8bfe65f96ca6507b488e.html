<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c"># Open and read HTMl / XML</span>
<span class="n">xml</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://www.tableausoftware.com/public/feed.rss&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c"># Grab article titles and links using regex</span>
<span class="n">xmlTitle</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;&amp;lt;title&amp;gt;(.*)&amp;lt;/title&amp;gt;&quot;</span><span class="p">)</span>
<span class="n">xmlLink</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;&amp;lt;link&amp;gt;(.*)&amp;lt;/link&amp;gt;&quot;</span><span class="p">)</span>

<span class="c"># Find and store the data</span>
<span class="n">findTitle</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">xmlTitle</span><span class="p">,</span><span class="n">xml</span><span class="p">)</span>
<span class="n">findLink</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">xmlLink</span><span class="p">,</span><span class="n">xml</span><span class="p">)</span>

<span class="c">#Iterate through the articles to create a range</span>
<span class="n">iterate</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">iterate</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="c"># Open the CSV file, write the headers</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;pytest.csv&quot;</span><span class="p">,</span> <span class="s">&quot;wb&quot;</span><span class="p">))</span>
<span class="n">head</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;Title&quot;</span><span class="p">,</span> <span class="s">&quot;URL&quot;</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>

<span class="c"># Using a For Loop, write the results to the CSV file, row by row</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterate</span><span class="p">:</span>
	<span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">findTitle</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">findLink</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</pre></div>