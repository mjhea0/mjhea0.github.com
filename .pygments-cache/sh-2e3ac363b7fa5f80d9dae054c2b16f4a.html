<div class="highlight"><pre>describe<span class="o">(</span><span class="s1">&#39;GET /api/v1/movies&#39;</span>, <span class="o">()</span> <span class="o">=</span>&gt; <span class="o">{</span>
  it<span class="o">(</span><span class="s1">&#39;should return all movies&#39;</span>, <span class="o">(</span><span class="k">done</span><span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
    request.get<span class="o">(</span><span class="sb">`</span><span class="k">${</span><span class="nv">base</span><span class="k">}</span>/api/v1/movies<span class="sb">`</span>, <span class="o">(</span>err, res, body<span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
      // there should be no errors
      should.not.exist<span class="o">(</span>err<span class="o">)</span><span class="p">;</span>
      // there should be a <span class="m">200</span> status code
      res.statusCode.should.eql<span class="o">(</span>200<span class="o">)</span><span class="p">;</span>
      // the response should be JSON
      res.headers<span class="o">[</span><span class="s1">&#39;content-type&#39;</span><span class="o">]</span>.should.contain<span class="o">(</span><span class="s1">&#39;application/json&#39;</span><span class="o">)</span><span class="p">;</span>
      // parse response body
      <span class="nv">body</span> <span class="o">=</span> JSON.parse<span class="o">(</span>body<span class="o">)</span><span class="p">;</span>
      // the JSON response body should have a
      // key-value pair of <span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;success&quot;</span><span class="o">}</span>
      body.status.should.eql<span class="o">(</span><span class="s1">&#39;success&#39;</span><span class="o">)</span><span class="p">;</span>
      // the JSON response body should have a
      // key-value pair of <span class="o">{</span><span class="s2">&quot;data&quot;</span>: <span class="o">[</span><span class="m">3</span> movie objects<span class="o">]}</span>
      body.data.length.should.eql<span class="o">(</span>3<span class="o">)</span><span class="p">;</span>
      // the first object in the data array should
      // have the right keys
      body.data<span class="o">[</span>0<span class="o">]</span>.should.include.keys<span class="o">(</span>
        <span class="s1">&#39;id&#39;</span>, <span class="s1">&#39;name&#39;</span>, <span class="s1">&#39;genre&#39;</span>, <span class="s1">&#39;rating&#39;</span>, <span class="s1">&#39;explicit&#39;</span>
      <span class="o">)</span><span class="p">;</span>
      // the first object should have the right value <span class="k">for</span> name
      body.data<span class="o">[</span>0<span class="o">]</span>.name.should.eql<span class="o">(</span><span class="s1">&#39;The Land Before Time&#39;</span><span class="o">)</span><span class="p">;</span>
      <span class="k">done</span><span class="o">()</span><span class="p">;</span>
    <span class="o">})</span><span class="p">;</span>
  <span class="o">})</span><span class="p">;</span>
<span class="o">})</span><span class="p">;</span>
</pre></div>