<div class="highlight"><pre><span class="kd">function</span> <span class="nx">createMoviesTaskDefinition</span><span class="p">(</span><span class="nx">accountID</span><span class="p">,</span> <span class="nx">region</span><span class="p">,</span> <span class="nx">tag</span><span class="p">,</span> <span class="nx">family</span><span class="p">,</span> <span class="nx">revision</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">taskDefinition</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">containerDefinitions</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;movies-service-review&#39;</span><span class="p">,</span>
        <span class="nx">image</span><span class="o">:</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">accountID</span><span class="p">}.</span><span class="nx">dkr</span><span class="p">.</span><span class="nx">ecr</span><span class="p">.</span><span class="nx">$</span><span class="p">{</span><span class="nx">region</span><span class="p">}.</span><span class="nx">amazonaws</span><span class="p">.</span><span class="nx">com</span><span class="err">\</span><span class="o">/</span><span class="nx">microservicemovies</span><span class="err">\</span><span class="o">/</span><span class="nx">movies</span><span class="o">-</span><span class="nx">service</span><span class="o">-</span><span class="nx">review</span><span class="o">:</span><span class="nx">$</span><span class="p">{</span><span class="nx">tag</span><span class="p">}</span><span class="err">`</span><span class="p">,</span>
        <span class="nx">essential</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">memoryReservation</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="nx">cpu</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="nx">portMappings</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nx">containerPort</span><span class="o">:</span> <span class="mi">3000</span><span class="p">,</span>
            <span class="nx">hostPort</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">protocol</span><span class="o">:</span> <span class="s1">&#39;tcp&#39;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">environment</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;DATABASE_URL&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;postgres://postgres:postgres@movies-db-review:5432/movies_dev&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;DATABASE_TEST_URL&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;postgres://postgres:postgres@movies-db-review:5432/movies_test&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;NODE_ENV&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;test&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;TOKEN_SECRET&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;changeme&#39;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">links</span><span class="o">:</span> <span class="p">[</span>
          <span class="s1">&#39;movies-db-review&#39;</span>
        <span class="p">],</span>
        <span class="nx">logConfiguration</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">logDriver</span><span class="o">:</span> <span class="s1">&#39;awslogs&#39;</span><span class="p">,</span>
          <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;awslogs-group&#39;</span><span class="o">:</span> <span class="s1">&#39;microservicemovies&#39;</span><span class="p">,</span>
            <span class="s1">&#39;awslogs-region&#39;</span><span class="o">:</span> <span class="nx">region</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;movies-db-review&#39;</span><span class="p">,</span>
        <span class="nx">image</span><span class="o">:</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">accountID</span><span class="p">}.</span><span class="nx">dkr</span><span class="p">.</span><span class="nx">ecr</span><span class="p">.</span><span class="nx">$</span><span class="p">{</span><span class="nx">region</span><span class="p">}.</span><span class="nx">amazonaws</span><span class="p">.</span><span class="nx">com</span><span class="err">\</span><span class="o">/</span><span class="nx">microservicemovies</span><span class="err">\</span><span class="o">/</span><span class="nx">movies</span><span class="o">-</span><span class="nx">db</span><span class="o">-</span><span class="nx">review</span><span class="o">:</span><span class="nx">$</span><span class="p">{</span><span class="nx">tag</span><span class="p">}</span><span class="err">`</span><span class="p">,</span>
        <span class="nx">essential</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">memoryReservation</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="nx">cpu</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="nx">portMappings</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nx">containerPort</span><span class="o">:</span> <span class="mi">5432</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">environment</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;POSTGRES_USER&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;postgres&#39;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;POSTGRES_PASSWORD&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;postgres&#39;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">logConfiguration</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">logDriver</span><span class="o">:</span> <span class="s1">&#39;awslogs&#39;</span><span class="p">,</span>
          <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;awslogs-group&#39;</span><span class="o">:</span> <span class="s1">&#39;microservicemovies&#39;</span><span class="p">,</span>
            <span class="s1">&#39;awslogs-region&#39;</span><span class="o">:</span> <span class="nx">region</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;swagger-review&quot;</span><span class="p">,</span>
        <span class="nx">image</span><span class="o">:</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">accountID</span><span class="p">}.</span><span class="nx">dkr</span><span class="p">.</span><span class="nx">ecr</span><span class="p">.</span><span class="nx">$</span><span class="p">{</span><span class="nx">region</span><span class="p">}.</span><span class="nx">amazonaws</span><span class="p">.</span><span class="nx">com</span><span class="err">\</span><span class="o">/</span><span class="nx">microservicemovies</span><span class="err">\</span><span class="o">/</span><span class="nx">swagger</span><span class="o">-</span><span class="nx">review</span><span class="o">:</span><span class="nx">$</span><span class="p">{</span><span class="nx">tag</span><span class="p">}</span><span class="err">`</span><span class="p">,</span>
        <span class="nx">essential</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">memoryReservation</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="nx">cpu</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="nx">portMappings</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nx">containerPort</span><span class="o">:</span> <span class="mi">3001</span><span class="p">,</span>
            <span class="nx">hostPort</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">protocol</span><span class="o">:</span> <span class="s2">&quot;tcp&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">environment</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;NODE_ENV&quot;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s2">&quot;test&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="nx">logConfiguration</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">logDriver</span><span class="o">:</span> <span class="s2">&quot;awslogs&quot;</span><span class="p">,</span>
          <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;awslogs-group&#39;</span><span class="o">:</span> <span class="s1">&#39;microservicemovies&#39;</span><span class="p">,</span>
            <span class="s1">&#39;awslogs-region&#39;</span><span class="o">:</span> <span class="nx">region</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nx">family</span><span class="o">:</span> <span class="s1">&#39;microservicemovies-review-movies-td&#39;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">taskDefinition</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">createMoviesTaskDefinition</span>
<span class="p">};</span>
</pre></div>